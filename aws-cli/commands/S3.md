## S3 commands

1. List buckets

```bash
# quickly list all s3 buckets
aws s3 ls
# 
# lists only bucket names
aws s3api list-buckets --query "Buckets[].Name"
```
2. Check bucket exits or not
```bash
# if bucket exists, it returns BucketRegion
aws s3api head-bucket --bucket my-bucket-name
```

3. Uploading file to S3 bucket
```bash
# upload files to specific bucket
aws s3 cp myfile.txt s3://my-bucket-name/ 

# upload files to specific bucket with custom name
aws s3 cp myfile.txt s3://my-bucket-name/customname.txt

# upload entire directory to specific bucket
aws s3 cp mydir s3://my-bucket-name/ --recursive    

# upload file with s3api with metadata
aws s3api put-object --bucket my-bucket-name --key myfile.txt --body myfile.txt --metadata key1=value1,key2=value2
```
4. listing objects in buckets
```bash
# list all objects in bucket
aws s3 ls s3://my-bucket-name/

# list all objects in bucket with human readable size
aws s3 ls s3://my-bucket-name/ --human-readable --summarize

# list all object low level details
aws s3api list-objects --bucket my-bucket-name

# get a specific object metadata
aws s3api head-object --bucket my-bucket-name --key myfile.txt

# get a specific object metadata with custom output format
aws s3api head-object --bucket my-bucket-name --key myfile.txt --output json
```
5. Enable static website hosting on bucket ([Ref](https://docs.aws.amazon.com/cli/latest/reference/s3api/put-bucket-website.html))
```bash
# high level command
aws s3 website s3://my-bucket-name/ --index-document index.html --error-document error.html

# low level command
aws s3api put-bucket-website --bucket my-bucket-name --website-configuration file://website.json
    
# website.json example  
    {
        "IndexDocument": {
            "Suffix": "index.html"
        },
        "ErrorDocument": {
            "Key": "error.html"
        }
    }

# set public read access policy to the bucket
aws s3api put-bucket-acl --bucket my-bucket-name --acl public-read

# bucket policy to allow public read access to all objects in the bucket
aws s3api put-bucket-policy --bucket my-bucket-name --policy file://bucket-policy.json

# bucket-policy.json example
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PublicReadGetObject",
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::my-bucket-name/*"
        }
    ]
}
```